/*****************************************************************************
  1 头文件包含
*****************************************************************************/
#include "gtest/gtest.h"
#include "llt_mockcpp.h"

using namespace testing;

/* 使用到C中函数和全局变量请放这里 */
#ifdef __cplusplus
extern "C"
{
#endif

extern int test_NFExt_IsOmData_001(void);
extern unsigned int test_NFExt_IsOmData_002(void);
extern unsigned int test_NFExt_IsOmData_003(void);
extern void init_test_NFExt_STUB_envirment(void);
extern void recover_test_NFExt_STUB_envirment(void);
extern void test_NFExt_BrDataExport_001(void);
extern void IPS_MNTN_BridgePktInfoCB(
    const unsigned char *,
    const unsigned char *,
    unsigned char *,
    unsigned short,
    unsigned short);
extern void test_NFExt_BrDataExport_001(void);
extern void test_NFExt_BrDataExport_002(void);
extern void test_NFExt_ArpDataExport_001(void);
extern void test_NFExt_IpDataExport_001(void);
extern void test_NFExt_IpDataExport_002(void);
extern void test_NFExt_IpDataExport_003(void);
extern unsigned int test_NFExt_BrPreRoutingHook_001(void);
extern unsigned int test_NFExt_BrPreRoutingHook_002(void);
extern int NFExt_IsOmData(void *skb);
extern void IPS_MNTN_PktInfoCB
(
    const unsigned char                        *pucNetIfName,
    const unsigned char                        *pucPktData,
    unsigned short                              usPktLen,
    unsigned short     usType
);
extern void NFExt_BrDataExport( void *skb,
                                void *device_in,
                                void *device_out,
                                unsigned short usType);
extern void test_NFExt_BrPostRoutingHook_001(void);
extern void IPS_MNTN_CtrlPktInfoCB
(
    const unsigned char                        *pucNetIfName,
    const unsigned char                        *pucPktData,
    unsigned short                              usPktLen,
    unsigned short     usType
);
extern void test_NFExt_BrPostRoutingHook_002(void);
extern unsigned int test_NFExt_BrLocalInHook_001(void);
extern unsigned int test_NFExt_BrLocalInHook_002(void);
extern unsigned int test_NFExt_BrLocalOutHook_001(void);
extern unsigned int test_NFExt_BrLocalOutHook_002(void);
extern unsigned int test_NFExt_BrForwardHook_001(void);
extern unsigned int test_NFExt_ArpInHook_001(void);
extern unsigned int test_NFExt_ArpOutHook_001(void);
extern unsigned int test_NFExt_Ip4PreRoutingHook_001(void);
extern unsigned int test_NFExt_Ip4PostRoutingHook_001(void);
extern unsigned int test_NFExt_Ip4LocalInHook_001(void);
extern unsigned int test_NFExt_Ip4LocalOutHook_001(void);
extern unsigned int test_NFExt_Ip4ForwardHook_001(void);
extern unsigned int test_NFExt_Ip6PreRoutingHook_001(void);
extern unsigned int test_NFExt_Ip6PostRoutingHook_001(void);
extern unsigned int test_NFExt_Ip6LocalInHook_001(void);
extern unsigned int test_NFExt_Ip6LocalOutHook_001(void);
extern unsigned int test_NFExt_Ip6ForwardHook_001(void);
extern int  NFExt_RegHooks(unsigned int);
extern int test_NFExt_BrForwardFlowCtrlHook_001(void);
extern int test_NFExt_BrForwardFlowCtrlHook_002(void);



#ifdef __cplusplus
}
#endif

/* 以下是用例 */
/*****************************************************************************
 被测函数  : test_NFExt_IsOmData
 被测功能  : 对桩test_NFExt_IsOmData测试
 用例条件  : 待勾取的报文是UDP报文

 修改历史      :
  1.日    期   : 2014年5月17日
    作    者   : liukai
    修改内容   : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IsOmData, NFExt_IsOmData_001)
{
    int result;
    /*************************************************************************
      (1)初始化测试环境
    *************************************************************************/


    /*************************************************************************
      (2)设置被测函数形参
    *************************************************************************/


    /*************************************************************************
      (3)执行被测函数
    *************************************************************************/

    result = test_NFExt_IsOmData_001();

    /*************************************************************************
      (4)检测测试结果
    *************************************************************************/
    EXPECT_EQ(0, result);//NF_EXT_FLAG_NOT_OM_DATA

    /*************************************************************************
      (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
 }

/*****************************************************************************
 被测函数   : test_NFExt_IsOmData
 被测功能   : 对桩test_NFExt_IsOmData测试
 用例条件   : 待勾取的报文是TCP报文且目的端口和ip和OM匹配

 修改历史       :
 1.日    期 : 2014年5月17日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IsOmData, NFExt_IsOmData_002)
{
    unsigned int result;
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/


    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/


    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/

    result = test_NFExt_IsOmData_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    EXPECT_EQ(0,result);//NF_EXT_FLAG_OM_DATA

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IsOmData
 被测功能   : 对桩test_NFExt_IsOmData测试
 用例条件   : 待勾取的报文是TCP报文且目的和源端口和ip和OM均不匹配

 修改历史       :
 1.日    期 : 2014年5月17日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IsOmData, NFExt_IsOmData_003)
{
    unsigned int result;
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/


    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/


    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/

    result = test_NFExt_IsOmData_003();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    EXPECT_EQ(1, result);//NF_EXT_FLAG_NOT_OM_DATA

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IsOmData
 被测功能   : 对桩test_NFExt_IsOmData测试
 用例条件   : 将勾取网桥中转报文导出到SDT

 修改历史       :
 1.日    期 : 2014年5月17日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrDataExport, NFExt_IsOmData_001)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/
    init_test_NFExt_STUB_envirment();

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    //MOCKER(IPS_MNTN_BridgePktInfoCB).stubs().with(eq(stDevIn.name), eq(stDevOut.name), eq(pucData), eq(100)).expects(once());
    MOCKER(IPS_MNTN_BridgePktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_BrDataExport_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    recover_test_NFExt_STUB_envirment();
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IsOmData
 被测功能   : 对桩test_NFExt_IsOmData测试
 用例条件   : 将勾取网桥中转报文导出到SDT

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrDataExport, NFExt_IsOmData_002)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/
    init_test_NFExt_STUB_envirment();

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
//    MOCKER(IPS_MNTN_BridgePktInfoCB).with(eq(stDevIn.name), eq(stDevOut.name), eq(pucData), eq(NF_EXT_MAX_IP_SIZE)).expects(once());
    MOCKER(IPS_MNTN_BridgePktInfoCB)
        .expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_BrDataExport_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    recover_test_NFExt_STUB_envirment();
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_ArpDataExport
 被测功能   : 对桩test_NFExt_ArpDataExport测试
 用例条件   : 将勾取ARP报文导出到SDT

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_ArpDataExport, NFExt_ArpDataExport_001)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/
    init_test_NFExt_STUB_envirment();

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
//MOCKER(IPS_MNTN_BridgePktInfoCB).with(any(), any(), mirror(pucData, 100), eq(100), eq(ID_IPS_TRACE_BRIDGE_DATA_INFO));
    MOCKER(IPS_MNTN_CtrlPktInfoCB)
        .expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_ArpDataExport_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    recover_test_NFExt_STUB_envirment();
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IpDataExport
 被测功能   : 对桩test_NFExt_IpDataExport测试
 用例条件   : 将勾取ARP报文导出到SDT

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IpDataExport, NFExt_IpDataExport_001)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_IpDataExport_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IpDataExport
 被测功能   : 对桩test_NFExt_IpDataExport测试
 用例条件   : 将勾取ARP报文导出到SDT

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IpDataExport, NFExt_IpDataExport_002)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_IpDataExport_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_IpDataExport
 被测功能   : 对桩test_NFExt_IpDataExport测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_IpDataExport, NFExt_IpDataExport_003)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/
    init_test_NFExt_STUB_envirment();

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_IpDataExport_003();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    recover_test_NFExt_STUB_envirment();
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrPreRoutingHook
 被测功能   : 对桩test_NFExt_BrPreRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrPreRoutingHook, NFExt_BrPreRoutingHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrPreRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrPreRoutingHook
 被测功能   : 对桩test_NFExt_BrPreRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrPreRoutingHook, NFExt_BrPreRoutingHook_002)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(NFExt_BrDataExport).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrPreRoutingHook_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrPostRoutingHook
 被测功能   : 对桩test_NFExt_BrPostRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrPostRoutingHook, NFExt_BrPostRoutingHook_001)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_BrPostRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrPostRoutingHook
 被测功能   : 对桩test_NFExt_BrPostRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrPostRoutingHook, NFExt_BrPostRoutingHook_002)
{
    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(NFExt_BrDataExport).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    test_NFExt_BrPostRoutingHook_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrLocalInHook
 被测功能   : 对桩test_NFExt_BrLocalInHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrLocalInHook, NFExt_BrLocalInHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrLocalInHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrLocalInHook
 被测功能   : 对桩test_NFExt_BrLocalInHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrLocalInHook, NFExt_BrLocalInHook_002)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(NFExt_BrDataExport).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrLocalInHook_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrLocalOutHook
 被测功能   : 对桩test_NFExt_BrLocalOutHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrLocalOutHook_001, NFExt_BrLocalOutHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrLocalOutHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrLocalOutHook
 被测功能   : 对桩test_NFExt_BrLocalOutHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrLocalOutHook_002, NFExt_BrLocalOutHook_002)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(NFExt_BrDataExport).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrLocalOutHook_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrForwardHook
 被测功能   : 对桩test_NFExt_BrForwardHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrForwardHook_001, NFExt_BrForwardHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(IPS_MNTN_BridgePktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrForwardHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_ArpInHook
 被测功能   : 对桩test_NFExt_ArpInHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_ArpInHook_001, NFExt_ArpInHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(IPS_MNTN_CtrlPktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_ArpInHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_ArpOutHook_001
 被测功能   : 对桩test_NFExt_ArpOutHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_ArpOutHook_001, NFExt_ArpOutHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(IPS_MNTN_CtrlPktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_ArpOutHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip4PreRoutingHook_001
 被测功能   : 对桩test_NFExt_Ip4PreRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月19日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip4PreRoutingHook_001, NFExt_Ip4PreRoutingHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip4PreRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip4PostRoutingHook_001
 被测功能   : 对桩test_NFExt_Ip4PostRoutingHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月22日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip4PostRoutingHook_001, NFExt_Ip4PostRoutingHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip4PostRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip4LocalInHook_001
 被测功能   : 对桩test_NFExt_Ip4LocalInHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip4LocalInHook_001, NFExt_Ip4LocalInHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip4LocalInHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip4LocalOutHook_001
 被测功能   : 对桩test_NFExt_Ip4LocalOutHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip4LocalOutHook_001, NFExt_Ip4LocalOutHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip4LocalOutHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip4ForwardHook_001
 被测功能   : 对桩test_NFExt_Ip4ForwardHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip4ForwardHook_001, NFExt_Ip4ForwardHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip4ForwardHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip6PreRoutingHook_001
 被测功能   : 对桩test_NFExt_Ip4ForwardHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip6PreRoutingHook_001, NFExt_Ip6PreRoutingHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip6PreRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip6PostRoutingHook_001
 被测功能   : 对桩test_NFExt_Ip4ForwardHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip6PostRoutingHook_001, NFExt_Ip6PostRoutingHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip6PostRoutingHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip6LocalInHook_001
 被测功能   : 对桩test_NFExt_Ip6LocalInHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip6LocalInHook_001, NFExt_Ip6LocalInHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip6LocalInHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip6LocalOutHook_001
 被测功能   : 对桩test_NFExt_Ip6LocalOutHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip6LocalOutHook_001, NFExt_Ip6LocalOutHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip6LocalOutHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_Ip6ForwardHook_001
 被测功能   : 对桩test_NFExt_Ip6ForwardHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_Ip6ForwardHook_001, NFExt_Ip6ForwardHook_001)
{
    unsigned int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_IsOmData).stubs().will(returnValue(1));
    MOCKER(IPS_MNTN_PktInfoCB).expects(once());

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_Ip6ForwardHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    GlobalMockObject::verify();
    EXPECT_EQ(1, result);

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrForwardFlowCtrlHook_001
 被测功能   : 对桩test_NFExt_BrForwardFlowCtrlHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrForwardFlowCtrlHook_001, NFExt_BrForwardFlowCtrlHook_001)
{
    int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_RegHooks).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrForwardFlowCtrlHook_001();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    EXPECT_EQ(0, result);//NF_DROP

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

/*****************************************************************************
 被测函数   : test_NFExt_BrForwardFlowCtrlHook_002
 被测功能   : 对桩test_NFExt_BrForwardFlowCtrlHook测试
 用例条件   :

 修改历史       :
 1.日    期 : 2014年5月20日
   作    者 : liukai
   修改内容 : 新生成linux WinGDB UT用例

*****************************************************************************/
TEST(test_test_NFExt_BrForwardFlowCtrlHook_002, NFExt_BrForwardFlowCtrlHook_002)
{
    int result     = 0;

    /*************************************************************************
    (1)初始化测试环境
    *************************************************************************/

    /*************************************************************************
    (2)设置被测函数形参
    *************************************************************************/
    MOCKER(NFExt_RegHooks).stubs().will(returnValue(0));

    /*************************************************************************
    (3)执行被测函数
    *************************************************************************/
    result = test_NFExt_BrForwardFlowCtrlHook_002();

    /*************************************************************************
    (4)检测测试结果
    *************************************************************************/
    EXPECT_EQ(1, result);//NF_ACCEPT

    /*************************************************************************
    (5)清理测试环境
    *************************************************************************/
    GlobalMockObject::reset();
}

